<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tank Components Database</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    body {
      padding-top: 20px;
      padding-bottom: 40px;
    }
    .header {
      margin-bottom: 30px;
    }
    pre {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      max-height: 400px;
      overflow-y: auto;
    }
    .component-info {
      margin-top: 20px;
    }
    .attribute-card {
      margin-bottom: 15px;
    }
    .component-dropdown {
      max-height: 500px;
      overflow-y: auto;
    }
    .stat-label {
      font-weight: 600;
      color: #495057;
    }
    .stat-value {
      font-family: monospace;
    }
    .component-tabs {
      margin-top: 20px;
    }
    .attribute-section {
      margin-bottom: 25px;
    }
    .search-box {
      margin-bottom: 15px;
    }
    .tier-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 0.9rem;
    }
    .shell-card {
      background-color: rgba(0,0,0,.03);
      border-radius: 5px;
      padding: 12px;
      margin-bottom: 10px;
    }
    .top-info {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }
    #loadingSpinner {
      display: none;
    }
    .component-selector {
      position: sticky;
      top: 0;
      z-index: 100;
      background-color: #fff;
      padding: 15px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,.1);
      margin-bottom: 20px;
    }
    .attribute-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-bottom: 15px;
    }
    .attribute-item {
      background-color: #f8f9fa;
      padding: 8px 12px;
      border-radius: 4px;
    }
    .data-version {
      font-size: 0.8rem;
      font-style: italic;
      color: #6c757d;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="text-center">Tank Components Database</h1>
      <p class="lead text-center">Browse detailed specifications for tank components</p>
    </div>

    <div id="loadingSpinner" class="text-center my-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading component data...</p>
    </div>

    <div class="component-selector">
      <div class="row">
        <div class="col-md-4">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <h5 class="mb-0">Guns</h5>
            </div>
            <div class="card-body p-0">
              <div class="search-box p-2">
                <input type="text" class="form-control" id="searchGuns" placeholder="Search guns...">
              </div>
              <div class="list-group component-dropdown" id="gunsList">
                <a href="#" class="list-group-item list-group-item-action disabled">Loading guns...</a>
              </div>
              <div class="p-2 data-version" id="gunsDataVersion"></div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-header bg-success text-white">
              <h5 class="mb-0">Turrets</h5>
            </div>
            <div class="card-body p-0">
              <div class="search-box p-2">
                <input type="text" class="form-control" id="searchTurrets" placeholder="Search turrets...">
              </div>
              <div class="list-group component-dropdown" id="turretsList">
                <a href="#" class="list-group-item list-group-item-action disabled">Loading turrets...</a>
              </div>
              <div class="p-2 data-version" id="turretsDataVersion"></div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-header bg-info text-white">
              <h5 class="mb-0">Hulls</h5>
            </div>
            <div class="card-body p-0">
              <div class="search-box p-2">
                <input type="text" class="form-control" id="searchHulls" placeholder="Search hulls...">
              </div>
              <div class="list-group component-dropdown" id="hullsList">
                <a href="#" class="list-group-item list-group-item-action disabled">Loading hulls...</a>
              </div>
              <div class="p-2 data-version" id="hullsDataVersion"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="component-info">
      <div id="componentDetails">
        <div class="text-center py-5">
          <i class="bi bi-arrow-up-circle fs-1 text-muted"></i>
          <h4 class="mt-3 text-muted">Select a component from above to view details</h4>
        </div>
      </div>
    </div>

    <footer class="mt-5 text-center text-muted">
      <p>Tank Components Database - <a href="https://github.com/Timo3D/tanmk-components-api">GitHub Repository</a></p>
    </footer>
  </div>

  <!-- Templates -->
  <template id="gunDetailsTemplate">
    <div class="card">
      <div class="card-header">
        <div class="top-info">
          <h3 id="gunName" class="mb-0"></h3>
          <span id="gunTier" class="badge bg-primary"></span>
        </div>
        <div class="text-muted mt-2" id="gunBasicInfo"></div>
      </div>
      <div class="card-body">
        <ul class="nav nav-tabs component-tabs" id="gunTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="gun-overview-tab" data-bs-toggle="tab" data-bs-target="#gun-overview" type="button" role="tab" aria-controls="gun-overview" aria-selected="true">Overview</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="gun-shells-tab" data-bs-toggle="tab" data-bs-target="#gun-shells" type="button" role="tab" aria-controls="gun-shells" aria-selected="false">Shells</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="gun-json-tab" data-bs-toggle="tab" data-bs-target="#gun-json" type="button" role="tab" aria-controls="gun-json" aria-selected="false">Raw JSON</button>
          </li>
        </ul>
        <div class="tab-content mt-3" id="gunTabContent">
          <div class="tab-pane fade show active" id="gun-overview" role="tabpanel" aria-labelledby="gun-overview-tab">
            <div class="row">
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Attributes</h5>
                  <div id="gunAttributes" class="attribute-grid"></div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Configuration</h5>
                  <div id="gunConfig" class="attribute-grid"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="gun-shells" role="tabpanel" aria-labelledby="gun-shells-tab">
            <h5>Available Shells</h5>
            <div id="gunShells"></div>
          </div>
          <div class="tab-pane fade" id="gun-json" role="tabpanel" aria-labelledby="gun-json-tab">
            <pre id="gunRawJson"></pre>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="turretDetailsTemplate">
    <div class="card">
      <div class="card-header">
        <div class="top-info">
          <h3 id="turretName" class="mb-0"></h3>
          <span id="turretTier" class="badge bg-success"></span>
        </div>
        <div class="text-muted mt-2" id="turretBasicInfo"></div>
      </div>
      <div class="card-body">
        <ul class="nav nav-tabs component-tabs" id="turretTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="turret-overview-tab" data-bs-toggle="tab" data-bs-target="#turret-overview" type="button" role="tab" aria-controls="turret-overview" aria-selected="true">Overview</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="turret-crew-tab" data-bs-toggle="tab" data-bs-target="#turret-crew" type="button" role="tab" aria-controls="turret-crew" aria-selected="false">Crew</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="turret-json-tab" data-bs-toggle="tab" data-bs-target="#turret-json" type="button" role="tab" aria-controls="turret-json" aria-selected="false">Raw JSON</button>
          </li>
        </ul>
        <div class="tab-content mt-3" id="turretTabContent">
          <div class="tab-pane fade show active" id="turret-overview" role="tabpanel" aria-labelledby="turret-overview-tab">
            <div class="row">
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Attributes</h5>
                  <div id="turretAttributes" class="attribute-grid"></div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Configuration</h5>
                  <div id="turretConfig" class="attribute-grid"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="turret-crew" role="tabpanel" aria-labelledby="turret-crew-tab">
            <h5>Crew Members</h5>
            <div id="turretCrew"></div>
          </div>
          <div class="tab-pane fade" id="turret-json" role="tabpanel" aria-labelledby="turret-json-tab">
            <pre id="turretRawJson"></pre>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="hullDetailsTemplate">
    <div class="card">
      <div class="card-header">
        <div class="top-info">
          <h3 id="hullName" class="mb-0"></h3>
          <span id="hullTier" class="badge bg-info"></span>
        </div>
        <div class="text-muted mt-2" id="hullBasicInfo"></div>
      </div>
      <div class="card-body">
        <ul class="nav nav-tabs component-tabs" id="hullTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="hull-overview-tab" data-bs-toggle="tab" data-bs-target="#hull-overview" type="button" role="tab" aria-controls="hull-overview" aria-selected="true">Overview</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="hull-mobility-tab" data-bs-toggle="tab" data-bs-target="#hull-mobility" type="button" role="tab" aria-controls="hull-mobility" aria-selected="false">Mobility</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="hull-json-tab" data-bs-toggle="tab" data-bs-target="#hull-json" type="button" role="tab" aria-controls="hull-json" aria-selected="false">Raw JSON</button>
          </li>
        </ul>
        <div class="tab-content mt-3" id="hullTabContent">
          <div class="tab-pane fade show active" id="hull-overview" role="tabpanel" aria-labelledby="hull-overview-tab">
            <div class="row">
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Attributes</h5>
                  <div id="hullAttributes" class="attribute-grid"></div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="attribute-section">
                  <h5>Configuration</h5>
                  <div id="hullConfig" class="attribute-grid"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="hull-mobility" role="tabpanel" aria-labelledby="hull-mobility-tab">
            <h5>Mobility Characteristics</h5>
            <div id="hullMobility"></div>
          </div>
          <div class="tab-pane fade" id="hull-json" role="tabpanel" aria-labelledby="hull-json-tab">
            <pre id="hullRawJson"></pre>
          </div>
        </div>
      </div>
    </div>
  </template>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Base URL for data files
    const DATA_BASE_URL = './data';
    
    // Component data storage
    const componentData = {
      guns: null,
      turrets: null,
      hulls: null
    };
    
    // DOM elements
    const gunsListElement = document.getElementById('gunsList');
    const turretsListElement = document.getElementById('turretsList');
    const hullsListElement = document.getElementById('hullsList');
    const componentDetailsElement = document.getElementById('componentDetails');
    const loadingSpinner = document.getElementById('loadingSpinner');
    
    // Data version elements
    const gunsDataVersion = document.getElementById('gunsDataVersion');
    const turretsDataVersion = document.getElementById('turretsDataVersion');
    const hullsDataVersion = document.getElementById('hullsDataVersion');
    
    // Search inputs
    const searchGunsInput = document.getElementById('searchGuns');
    const searchTurretsInput = document.getElementById('searchTurrets');
    const searchHullsInput = document.getElementById('searchHulls');
    
    // Templates
    const gunDetailsTemplate = document.getElementById('gunDetailsTemplate');
    const turretDetailsTemplate = document.getElementById('turretDetailsTemplate');
    const hullDetailsTemplate = document.getElementById('hullDetailsTemplate');
    
    // Initialize the app
    document.addEventListener('DOMContentLoaded', () => {
      loadComponentData();
      
      // Set up search filters
      searchGunsInput.addEventListener('input', (e) => filterComponentList('guns', e.target.value));
      searchTurretsInput.addEventListener('input', (e) => filterComponentList('turrets', e.target.value));
      searchHullsInput.addEventListener('input', (e) => filterComponentList('hulls', e.target.value));
    });
    
    // Load all component data
    async function loadComponentData() {
      loadingSpinner.style.display = 'block';
      
      try {
        // First try to load the combined components.json file
        try {
          const componentsResponse = await fetch(`${DATA_BASE_URL}/components.json`);
          if (componentsResponse.ok) {
            const combinedData = await componentsResponse.json();
            
            // Set turrets and hulls data from combined file
            if (combinedData.turrets) {
              componentData.turrets = { items: combinedData.turrets };
              populateComponentList('turrets', componentData.turrets);
              
              if (combinedData.lastUpdated) {
                turretsDataVersion.textContent = `Last updated: ${new Date(combinedData.lastUpdated).toLocaleString()}`;
              }
            }
            
            if (combinedData.hulls) {
              componentData.hulls = { items: combinedData.hulls };
              populateComponentList('hulls', componentData.hulls);
              
              if (combinedData.lastUpdated) {
                hullsDataVersion.textContent = `Last updated: ${new Date(combinedData.lastUpdated).toLocaleString()}`;
              }
            }
            
            console.log('Loaded combined components data');
          }
        } catch (combinedError) {
          console.warn('Failed to load combined components data:', combinedError);
        }
        
        // Load guns data from guns.json (for backward compatibility)
        try {
          const gunsResponse = await fetch(`${DATA_BASE_URL}/guns.json`);
          if (gunsResponse.ok) {
            componentData.guns = await gunsResponse.json();
            populateComponentList('guns', componentData.guns);
            
            if (componentData.guns.lastUpdated) {
              gunsDataVersion.textContent = `Last updated: ${new Date(componentData.guns.lastUpdated).toLocaleString()}`;
            }
          } else {
            setPlaceholder(gunsListElement, 'No guns data available');
          }
        } catch (gunsError) {
          console.warn('Failed to load guns data:', gunsError);
          setPlaceholder(gunsListElement, 'No guns data available');
        }
        
        // Try to load individual turrets and hulls files if not already loaded
        if (!componentData.turrets) {
          try {
            const turretsResponse = await fetch(`${DATA_BASE_URL}/turrets.json`);
            if (turretsResponse.ok) {
              componentData.turrets = await turretsResponse.json();
              populateComponentList('turrets', componentData.turrets);
              
              if (componentData.turrets.lastUpdated) {
                turretsDataVersion.textContent = `Last updated: ${new Date(componentData.turrets.lastUpdated).toLocaleString()}`;
              }
            } else {
              setPlaceholder(turretsListElement, 'No turrets data available');
            }
          } catch (error) {
            console.warn('Failed to load turrets data:', error);
            setPlaceholder(turretsListElement, 'No turrets data available');
          }
        }
        
        if (!componentData.hulls) {
          try {
            const hullsResponse = await fetch(`${DATA_BASE_URL}/hulls.json`);
            if (hullsResponse.ok) {
              componentData.hulls = await hullsResponse.json();
              populateComponentList('hulls', componentData.hulls);
              
              if (componentData.hulls.lastUpdated) {
                hullsDataVersion.textContent = `Last updated: ${new Date(componentData.hulls.lastUpdated).toLocaleString()}`;
              }
            } else {
              setPlaceholder(hullsListElement, 'No hulls data available');
            }
          } catch (error) {
            console.warn('Failed to load hulls data:', error);
            setPlaceholder(hullsListElement, 'No hulls data available');
          }
        }
        
      } catch (error) {
        console.error('Error loading component data:', error);
        alert('Error loading component data. Please check the console for details.');
      } finally {
        loadingSpinner.style.display = 'none';
      }
    }
    
    // Populate component list with data
    function populateComponentList(type, data) {
      const listElement = document.getElementById(`${type}List`);
      listElement.innerHTML = '';
      
      let items = null;
      
      // Handle different possible data structures
      if (data.items) {
        // Original format
        items = data.items;
      } else if (type === 'turrets' || type === 'hulls') {
        // New format where data is directly the items
        items = data;
      }
      
      if (!items || Object.keys(items).length === 0) {
        setPlaceholder(listElement, `No ${type} data available`);
        return;
      }
      
      // Sort components by name
      const sortedNames = Object.keys(items).sort();
      
      sortedNames.forEach(name => {
        const component = items[name];
        const item = document.createElement('a');
        item.href = '#';
        item.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
        
        // For guns, show caliber
        if (type === 'guns' && component.metadata?.config?.GunCaliber) {
          item.innerHTML = `
            ${name}
            <span class="badge bg-secondary rounded-pill">${component.metadata.config.GunCaliber}mm</span>
          `;
        } else {
          item.textContent = name;
        }
        
        item.addEventListener('click', (e) => {
          e.preventDefault();
          
          // Highlight the selected item
          listElement.querySelectorAll('a').forEach(el => el.classList.remove('active'));
          item.classList.add('active');
          
          // Display component details
          displayComponentDetails(type, name, component);
        });
        
        listElement.appendChild(item);
      });
    }
    
    // Filter component list based on search input
    function filterComponentList(type, searchQuery) {
      const listElement = document.getElementById(`${type}List`);
      const items = listElement.querySelectorAll('a');
      
      const query = searchQuery.toLowerCase();
      
      items.forEach(item => {
        const name = item.textContent.trim().toLowerCase();
        if (name.includes(query)) {
          item.style.display = 'block';
        } else {
          item.style.display = 'none';
        }
      });
    }
    
    // Display component details
    function displayComponentDetails(type, name, component) {
      // Clear previous content
      componentDetailsElement.innerHTML = '';
      
      // Clone the appropriate template
      let template;
      if (type === 'guns') {
        template = gunDetailsTemplate.content.cloneNode(true);
        displayGunDetails(template, name, component);
      } else if (type === 'turrets') {
        template = turretDetailsTemplate.content.cloneNode(true);
        displayTurretDetails(template, name, component);
      } else if (type === 'hulls') {
        template = hullDetailsTemplate.content.cloneNode(true);
        displayHullDetails(template, name, component);
      }
      
      componentDetailsElement.appendChild(template);
    }
    
    // Display gun details
    function displayGunDetails(template, name, gun) {
      // Set name and tier
      template.getElementById('gunName').textContent = name;
      
      const tier = gun.metadata.attributes?.Tier || 'Unknown';
      template.getElementById('gunTier').textContent = `Tier ${tier}`;
      
      // Set basic info
      const nation = gun.metadata.attributes?.Nation || 'Unknown Nation';
      const era = gun.metadata.attributes?.Era || 'Unknown Era';
      template.getElementById('gunBasicInfo').textContent = `${nation} • ${era} • ID: ${gun.id}`;
      
      // Populate attributes
      const attributesContainer = template.getElementById('gunAttributes');
      populateAttributeGrid(attributesContainer, gun.metadata?.attributes, ['CF']); // Exclude CF which is complex
      
      // Populate config
      const configContainer = template.getElementById('gunConfig');
      populateAttributeGrid(configContainer, gun.metadata?.config, ['Shells']); // Exclude Shells which is handled separately
      
      // Populate shells
      const shellsContainer = template.getElementById('gunShells');
      if (gun.metadata?.config?.Shells && Object.keys(gun.metadata.config.Shells).length > 0) {
        shellsContainer.innerHTML = '';
        
        Object.entries(gun.metadata.config.Shells).forEach(([shellType, shellData]) => {
          const shellCard = document.createElement('div');
          shellCard.className = 'shell-card';
          
          let shellContent = `
            <h6>${shellType} - ${shellData.ShellName || 'Unknown'}</h6>
            <div class="attribute-grid">
          `;
          
          // Add shell properties
          Object.entries(shellData).forEach(([key, value]) => {
            shellContent += `
              <div class="attribute-item">
                <div class="stat-label">${formatLabel(key)}</div>
                <div class="stat-value">${value}</div>
              </div>
            `;
          });
          
          shellContent += '</div>';
          shellCard.innerHTML = shellContent;
          shellsContainer.appendChild(shellCard);
        });
      } else {
        shellsContainer.innerHTML = '<p class="text-muted">No shell data available</p>';
      }
      
      // Set raw JSON
      template.getElementById('gunRawJson').textContent = JSON.stringify(gun, null, 2);
    }
    
    // Display turret details
    function displayTurretDetails(template, name, turret) {
      // Set name and tier
      template.getElementById('turretName').textContent = name;
      
      const tier = turret.metadata?.attributes?.Tier || 'Unknown';
      template.getElementById('turretTier').textContent = `Tier ${tier}`;
      
      // Set basic info
      const nation = turret.metadata?.attributes?.Nation || 'Unknown Nation';
      const era = turret.metadata?.attributes?.Era || 'Unknown Era';
      template.getElementById('turretBasicInfo').textContent = `${nation} • ${era} • ID: ${turret.id}`;
      
      // Populate attributes
      const attributesContainer = template.getElementById('turretAttributes');
      if (turret.metadata?.attributes) {
        populateAttributeGrid(attributesContainer, turret.metadata.attributes, ['CF']); // Exclude CF which is complex
      } else {
        attributesContainer.innerHTML = '<p class="text-muted">No attribute data available</p>';
      }
      
      // Populate config
      const configContainer = template.getElementById('turretConfig');
      if (turret.metadata?.config) {
        populateAttributeGrid(configContainer, turret.metadata.config, ['Shells']); // Exclude Shells which is handled separately
      } else {
        configContainer.innerHTML = '<p class="text-muted">No configuration data available</p>';
      }
      
      // Populate crew
      const crewContainer = template.getElementById('turretCrew');
      if (turret.metadata?.crew && turret.metadata.crew.length > 0) {
        const crewList = document.createElement('ul');
        crewList.className = 'list-group';
        
        turret.metadata.crew.forEach(crewMember => {
          const item = document.createElement('li');
          item.className = 'list-group-item';
          item.textContent = crewMember;
          crewList.appendChild(item);
        });
        
        crewContainer.appendChild(crewList);
      } else {
        crewContainer.innerHTML = '<p class="text-muted">No crew data available</p>';
      }
      
      // Set raw JSON
      template.getElementById('turretRawJson').textContent = JSON.stringify(turret, null, 2);
    }
    
    // Display hull details
    function displayHullDetails(template, name, hull) {
      // Set name and tier
      template.getElementById('hullName').textContent = name;
      
      const tier = hull.metadata?.attributes?.Tier || 'Unknown';
      template.getElementById('hullTier').textContent = `Tier ${tier}`;
      
      // Set basic info
      const nation = hull.metadata?.attributes?.Nation || 'Unknown Nation';
      const era = hull.metadata?.attributes?.Era || 'Unknown Era';
      template.getElementById('hullBasicInfo').textContent = `${nation} • ${era} • ID: ${hull.id}`;
      
      // Populate attributes
      const attributesContainer = template.getElementById('hullAttributes');
      if (hull.metadata?.attributes) {
        populateAttributeGrid(attributesContainer, hull.metadata.attributes, ['CF']); // Exclude CF which is complex
      } else {
        attributesContainer.innerHTML = '<p class="text-muted">No attribute data available</p>';
      }
      
      // Populate config
      const configContainer = template.getElementById('hullConfig');
      if (hull.metadata?.config) {
        populateAttributeGrid(configContainer, hull.metadata.config, [
          'ForwardGears', 'ReverseGears', 'TrackColour' // These will be displayed in mobility tab
        ]);
      } else {
        configContainer.innerHTML = '<p class="text-muted">No configuration data available</p>';
      }
      
      // Populate mobility details
      const mobilityContainer = template.getElementById('hullMobility');
      if (hull.metadata?.config) {
        const mobilityInfo = document.createElement('div');
        
        // Create a card for gears
        if (hull.metadata.config.ForwardGears || hull.metadata.config.ReverseGears) {
          const gearsCard = document.createElement('div');
          gearsCard.className = 'card mb-3';
          
          let gearsContent = `
            <div class="card-header">Transmission</div>
            <div class="card-body">
              <div class="row">
          `;
          
          if (hull.metadata.config.ForwardGears) {
            gearsContent += `
              <div class="col-md-6">
                <h6>Forward Gears</h6>
                <p class="mb-0">${hull.metadata.config.ForwardGears}</p>
              </div>
            `;
          }
          
          if (hull.metadata.config.ReverseGears) {
            gearsContent += `
              <div class="col-md-6">
                <h6>Reverse Gears</h6>
                <p class="mb-0">${hull.metadata.config.ReverseGears}</p>
              </div>
            `;
          }
          
          gearsContent += `
              </div>
            </div>
          `;
          
          gearsCard.innerHTML = gearsContent;
          mobilityInfo.appendChild(gearsCard);
        }
        
        // Create a card for general mobility stats
        const mobilityCard = document.createElement('div');
        mobilityCard.className = 'card';
        
        let content = `
          <div class="card-header">Mobility Characteristics</div>
          <div class="card-body">
            <div class="attribute-grid">
        `;
        
        // Mobility-related attributes
        const mobilityAttrs = [
          'TurnSpeed', 'Acceleration', 'Torque', 'HullWeight', 
          'WheelFriction', 'MaxSteerAngle', 'NeutralSteer'
        ];
        
        mobilityAttrs.forEach(attr => {
          if (hull.metadata.config[attr] !== undefined) {
            content += `
              <div class="attribute-item">
                <div class="stat-label">${formatLabel(attr)}</div>
                <div class="stat-value">${formatValue(hull.metadata.config[attr])}</div>
              </div>
            `;
          }
        });
        
        content += `
            </div>
          </div>
        `;
        
        mobilityCard.innerHTML = content;
        mobilityInfo.appendChild(mobilityCard);
        
        mobilityContainer.appendChild(mobilityInfo);
      } else {
        mobilityContainer.innerHTML = '<p class="text-muted">No mobility data available</p>';
      }
      
      // Set raw JSON
      template.getElementById('hullRawJson').textContent = JSON.stringify(hull, null, 2);
    }
    
    // Populate an attribute grid with data
    function populateAttributeGrid(container, data, exclusions = []) {
      container.innerHTML = '';
      
      if (!data || Object.keys(data).length === 0) {
        container.innerHTML = '<p class="text-muted">No data available</p>';
        return;
      }
      
      // Filter and sort attributes
      const attributes = Object.entries(data)
        .filter(([key]) => !exclusions.includes(key))
        .sort((a, b) => a[0].localeCompare(b[0]));
      
      attributes.forEach(([key, value]) => {
        const attrElement = document.createElement('div');
        attrElement.className = 'attribute-item';
        
        attrElement.innerHTML = `
          <div class="stat-label">${formatLabel(key)}</div>
          <div class="stat-value">${formatValue(value)}</div>
        `;
        
        container.appendChild(attrElement);
      });
    }
    
    // Format a value for display
    function formatValue(value) {
      if (value === null || value === undefined) {
        return 'N/A';
      }
      
      if (typeof value === 'boolean') {
        return value ? 'Yes' : 'No';
      }
      
      if (typeof value === 'object') {
        if (value.type === 'Vector3' || value.type === 'Vector2') {
          return `${value.type}(${value.values.join(', ')})`;
        }
        
        if (value.type === 'Color3') {
          return `RGB(${value.values.join(', ')})`;
        }
        
        return JSON.stringify(value);
      }
      
      return value;
    }
    
    // Format a label from camelCase or snake_case to Title Case with spaces
    function formatLabel(label) {
      // Replace camelCase with spaces
      label = label.replace(/([A-Z])/g, ' $1');
      // Replace snake_case with spaces
      label = label.replace(/_/g, ' ');
      // Title case
      label = label.charAt(0).toUpperCase() + label.slice(1);
      return label;
    }
    
    // Set placeholder text in a list element
    function setPlaceholder(element, text) {
      element.innerHTML = `<a href="#" class="list-group-item list-group-item-action disabled">${text}</a>`;
    }
  </script>
</body>
</html>